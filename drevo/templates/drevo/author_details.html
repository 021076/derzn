{% extends 'base.html' %}
{% load static %}
{% load filter %}

{% block title %}Автор {{ author.name }}{% endblock %}

{% block cssfiles %}
<link rel="stylesheet" href="{% static '/drevo/css/drevo.css' %}">
{% endblock %}

{% block content %}

<h2>Автор {{ author.name }}</h2>

{% if author.info %}
<div class="row">
        <div class="col-md-4">
            {{ author.info|safe }}
        </div>
        {% if author.photo %}
        <div class="col-md-2">
            <img src="{% get_media_prefix %}{{ author.photo }}" class="rounded float-end img-thumbnail" alt="{{ author.name }}" width="200">
       </div>
        {% endif %}
</div>

<div class="row">
    <div class="col-md-4">
        {% if not zn_base|length_is:"0" %}
        <h2>Список знаний</h2>
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" onchange="toggleAddZnVisibility(this);">
            <label class="form-check-label" for="flexSwitchCheckDefault">Выводить только основные знания?</label>
          </div>
        <br>  
        <ul>
        {% for category in categories %}
            <li style="font-weight: 600;"><i class="bi-file-plus-fill lonely"></i><a href="{{ node.get_absolute_url }}">{{ category.name }}</a>
                <ul>
                {% for zn_base in zn_base_in_category|dict_value:category.name %}
                <li style="font-weight: 400;">
                    <i class="bi-file-text-fill" style="color: #99CCFF;"></i>
                    <a href="{% url 'zdetail' zn_base.pk %}" class="zn_base">{{ zn_base.name }}</a></li>
                    {% if not zn_add2base|dict_value:zn_base.pk|length_is:"0" %}
                    <ul class='ul_add'>
                        {% for zn_add in zn_add2base|dict_value:zn_base.pk %}
                        <li style="font-weight: 400;">
                            <i class="bi-file-text-fill" style="color: #ff9999;"></i>
                            <a href="{% url 'zdetail' zn_add.pk %}" class="zn_add">{{ zn_add.name }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                {% endfor %}
                </ul>
            </li>
        {% endfor %}
        </ul>
        {% endif %}
    </div>
</div>


{% endif %}

{% endblock %}

{% block jsfiles %}

<script>

function toggleAddZnVisibility(element){
    let ulToToggle = document.querySelectorAll('.ul_add');
    if (element.checked == true) {
        ulToToggle.forEach(function(x){
            x.hidden = true;
        }
        )
    }
    else {
        ulToToggle.forEach(function(x){
            x.hidden = false;
        }
        )        
    }
}
</script>

{% endblock %}